UserParameter=procinfo.discovery[*],ps -eo pid,comm,args | awk 'BEGIN{printf "{\n\t\"data\":[\n"} /^.+(awk|zabbix|sh)/{next} /^.+$1/{printf comma"\t\t{\"{#PROCNAME}\":\""$$2"\", \"{#PROCID}\":\""$$1"\", \"{#PROCARG}\":\""$$4"\"}"; comma=",\n"} END{print "\n\t]\n}"}' | egrep -v "awk|zabbix|sh|dhclient"
UserParameter=proc.listentcp.discovery[*],netstat -ltpn --inet | grep -P '^(?=.*tcp)(?=.*LISTEN)(?=.*($1))' | awk 'BEGIN{printf "{\n\t\"data\":[\n"} match($$4, /^([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+):([0-9]+)/, res) {printf comma"\t\t{\"{#PROCTCPLISTEN}\":\""res[2]"\", \"{#PROCLISTENIP}\":\""res[1]"\"}"; comma=",\n"} END{print "\n\t]\n}"}'